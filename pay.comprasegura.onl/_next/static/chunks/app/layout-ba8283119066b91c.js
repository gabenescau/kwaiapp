(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{38975:function(t,e,n){Promise.resolve().then(n.t.bind(n,39974,23)),Promise.resolve().then(n.t.bind(n,2778,23)),Promise.resolve().then(n.bind(n,66214)),Promise.resolve().then(n.bind(n,14483)),Promise.resolve().then(n.bind(n,30053)),Promise.resolve().then(n.bind(n,34990))},66214:function(t,e,n){"use strict";n.d(e,{PixelScriptsWrapper:function(){return g}});var i=n(57437),o=n(30053),r=n(48667);let c=[/document\.cookie/gi,/localStorage/gi,/sessionStorage/gi,/document\.write/gi,/innerHTML\s*=/gi,/outerHTML\s*=/gi,/\.submit\s*\(/gi,/form\.action/gi,/window\.location\s*=(?!.*(?:analytics|google|facebook|tiktok))/gi,/document\.location\s*=(?!.*(?:analytics|google|facebook|tiktok))/gi,/createElement\s*\(\s*['"]script['"]\s*\)/gi,/appendChild/gi,/insertBefore/gi,/\beval\s*\(/gi,/\bFunction\s*\(/gi,/setTimeout\s*\(\s*['"]/gi,/setInterval\s*\(\s*['"]/gi,/fetch\s*\(\s*['"](?!https:\/\/(?:analytics\.tiktok|www\.google-analytics|connect\.facebook|graph\.facebook|www\.googletagmanager))/gi,/XMLHttpRequest/gi,/atob\s*\(/gi,/btoa\s*\(/gi,/__proto__/gi,/constructor\s*\[/gi,/prototype\s*\[/gi],l=["analytics.tiktok.com","www.googletagmanager.com","www.google-analytics.com","connect.facebook.net","www.facebook.com","graph.facebook.com","snap.licdn.com","s.kwai.net","static.hotjar.com","cdn.segment.com"];function a(t){let e=[],n=[];if(!t||"string"!=typeof t)return{isValid:!1,sanitizedScript:null,warnings:["Script is empty or invalid"],blockedPatterns:[]};let i=t.trim();for(let t of c)t.test(i)&&n.push(t.source);if(n.length>0)return{isValid:!1,sanitizedScript:null,warnings:["Script contains potentially dangerous code"],blockedPatterns:n};if(i.length>5e4)return{isValid:!1,sanitizedScript:null,warnings:["Script exceeds maximum allowed length (50KB)"],blockedPatterns:[]};for(let t of((i.match(/[^\w\s]/g)||[]).length/i.length>.5&&i.length>500&&e.push("Script appears to be heavily obfuscated - review carefully"),i.match(/src\s*=\s*['"]([^'"]+)['"]/gi)||[])){let n=t.match(/['"]([^'"]+)['"]/);if(n){let t=n[1];try{let n=new URL(t);l.some(t=>n.hostname.endsWith(t))||e.push("External script from ".concat(n.hostname," - verify it's trusted"))}catch(n){e.push("Invalid URL in script: ".concat(t))}}}return{isValid:!0,sanitizedScript:i,warnings:e,blockedPatterns:[]}}function s(t){return t.replace(/[^a-zA-Z0-9_-]/g,"")}function u(t){var e,n,o,c,l;let{config:u}=t;if(!u)return null;let d=(null===(e=u.tiktok)||void 0===e?void 0:e.pixelId)?s(u.tiktok.pixelId):null,g=(null===(n=u.google)||void 0===n?void 0:n.measurementId)?s(u.google.measurementId):null,f=(null===(o=u.google)||void 0===o?void 0:o.conversionId)?s(u.google.conversionId):null,m=(null===(c=u.facebook)||void 0===c?void 0:c.pixelId)?s(u.facebook.pixelId):null,p=(null===(l=u.custom)||void 0===l?void 0:l.headScript)?a(u.custom.headScript):null;return(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsx)(r.default,{id:"tiktok-pixel",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:'\n              !function (w, d, t) {\n                w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n                ttq.load(\''.concat(d,"');\n                ttq.page();\n              }(window, document, 'ttq');\n            ")}}),g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.default,{src:"https://www.googletagmanager.com/gtag/js?id=".concat(g),strategy:"afterInteractive"}),(0,i.jsx)(r.default,{id:"google-analytics",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:"\n                window.dataLayer = window.dataLayer || [];\n                function gtag(){dataLayer.push(arguments);}\n                gtag('js', new Date());\n                gtag('config', '".concat(g,"');\n                ").concat(f?"gtag('config', '".concat(f,"');"):"","\n              ")}})]}),m&&(0,i.jsx)(r.default,{id:"facebook-pixel",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:"\n              !function(f,b,e,v,n,t,s)\n              {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n              n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n              if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n              n.queue=[];t=b.createElement(e);t.async=!0;\n              t.src=v;s=b.getElementsByTagName(e)[0];\n              s.parentNode.insertBefore(t,s)}(window, document,'script',\n              'https://connect.facebook.net/en_US/fbevents.js');\n              fbq('init', '".concat(m,"');\n              fbq('track', 'PageView');\n            ")}}),(null==p?void 0:p.isValid)&&p.sanitizedScript&&(0,i.jsx)(r.default,{id:"custom-head-script",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:p.sanitizedScript}})]})}function d(t){let{script:e}=t;if(!e)return null;let n=a(e);return n.isValid&&n.sanitizedScript?(0,i.jsx)(r.default,{id:"custom-body-script",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:n.sanitizedScript}}):null}function g(){var t;let{config:e,loading:n}=(0,o.w)();return n||!e?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u,{config:e}),(0,i.jsx)(d,{script:null===(t=e.custom)||void 0===t?void 0:t.bodyScript})]})}},14483:function(t,e,n){"use strict";n.d(e,{SessionProvider:function(){return r}});var i=n(57437),o=n(80605);function r(t){let{children:e}=t;return(0,i.jsx)(o.SessionProvider,{children:e})}},30053:function(t,e,n){"use strict";n.d(e,{PixelProvider:function(){return l},w:function(){return c}});var i=n(57437),o=n(2265);let r=(0,o.createContext)({config:null,loading:!0});function c(){return(0,o.useContext)(r)}function l(t){let{children:e}=t,[n,c]=(0,o.useState)(null),[l,a]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{(async function(){try{let t=await fetch("/api/store/pixels"),e=await t.json();e.success&&e.pixels&&c(e.pixels)}catch(t){console.error("[Pixels] Error loading config:",t)}finally{a(!1)}})()},[]),(0,i.jsx)(r.Provider,{value:{config:n,loading:l},children:e})}},34990:function(t,e,n){"use strict";n.d(e,{UTMProvider:function(){return f},v:function(){return g}});var i=n(57437),o=n(2265);let r="checkout_utms";function c(){if("undefined"==typeof document)return null;try{for(let t of document.cookie.split(";")){let[e,n]=t.trim().split("=");if("_ttp"===e)return n}}catch(t){}return null}function l(t){return Object.values(t).some(t=>void 0!==t&&""!==t)}function a(t){if(!l(t))return;let e={utms:t,timestamp:Date.now(),expiry:Date.now()+2592e6};try{localStorage.setItem(r,JSON.stringify(e))}catch(t){}}function s(){try{let t=localStorage.getItem(r);if(!t)return null;let e=JSON.parse(t);if(e.expiry&&Date.now()>e.expiry)return localStorage.removeItem(r),null;return e.utms||null}catch(t){return null}}function u(){let t=s(),e=c();if((!t||!l(t))&&!e)return;let n={};(null==t?void 0:t.utm_source)&&(n.source=t.utm_source),(null==t?void 0:t.utm_medium)&&(n.medium=t.utm_medium),(null==t?void 0:t.utm_campaign)&&(n.campaign=t.utm_campaign),(null==t?void 0:t.utm_term)&&(n.term=t.utm_term),(null==t?void 0:t.utm_content)&&(n.content=t.utm_content),(null==t?void 0:t.gclid)&&(n.gclid=t.gclid),(null==t?void 0:t.fbclid)&&(n.fbclid=t.fbclid),(null==t?void 0:t.ttclid)&&(n.ttclid=t.ttclid),e?n.ttp=e:(null==t?void 0:t.ttp)&&(n.ttp=t.ttp);let i=(null==t?void 0:t.gclid)||(null==t?void 0:t.fbclid)||(null==t?void 0:t.ttclid);return i&&(n.clickId=i),Object.keys(n).length>0?n:void 0}let d=(0,o.createContext)({utms:{},isReady:!1,getUTMsForOrder:u});function g(){return(0,o.useContext)(d)}function f(t){let{children:e}=t,[n,r]=(0,o.useState)({}),[g,f]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{r(function(){let t=function(t){let e=("string"==typeof t?new URL(t,"http://localhost"):t).searchParams,n={};return e.get("utm_source")&&(n.utm_source=e.get("utm_source")),e.get("utm_medium")&&(n.utm_medium=e.get("utm_medium")),e.get("utm_campaign")&&(n.utm_campaign=e.get("utm_campaign")),e.get("utm_term")&&(n.utm_term=e.get("utm_term")),e.get("utm_content")&&(n.utm_content=e.get("utm_content")),e.get("gclid")&&(n.gclid=e.get("gclid")),e.get("fbclid")&&(n.fbclid=e.get("fbclid")),e.get("ttclid")&&(n.ttclid=e.get("ttclid")),e.get("ref")&&(n.ref=e.get("ref")),n}(window.location.href),e=c();if(e&&(t.ttp=e),l(t))return a(t),t;let n=s()||{};return e&&!n.ttp&&(n.ttp=e,a(n)),n}()),f(!0)},[]),(0,i.jsx)(d.Provider,{value:{utms:n,isReady:g,getUTMsForOrder:u},children:e})}},2778:function(){}},function(t){t.O(0,[1919,2461,605,2825,2971,2117,1744],function(){return t(t.s=38975)}),_N_E=t.O()}]);